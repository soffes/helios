# Press on once to turn on bright scene. Press it again to turn on the full scene.
- id: bedroom_switch_on
  alias: Bedroom Switch - On (Bright)
  mode: single
  trigger:
    - trigger: state
      entity_id: event.bedroom_switch_up
  action:
    - action: scene.turn_on
      target:
        entity_id: >
          {% set brightness = state_attr("light.bedroom_lamps", "brightness") %}
          {% if brightness and brightness == 255 %}
            scene.bedroom_full
          {% else %}
            scene.bedroom_bright
          {% endif %}

- id: bedroom_switch_off
  alias: Bedroom Switch - Off
  mode: single
  use_blueprint:
    path: soffes/event_scene.yaml
    input:
      event: event.bedroom_switch_down
      scene: scene.bedroom_off

- id: bedroom_switch_config
  alias: Bedroom Switch - Config
  mode: single
  use_blueprint:
    path: soffes/event_scene.yaml
    input:
      event: event.bedroom_switch_config
      scene: scene.bedtime

- id: bedroom_everyday_calendar_daytime
  alias: Bedroom Everyday Calendar - Daytime
  mode: single
  trigger:
    - trigger: state
      entity_id: light.bedroom_lamp_s
      to: "on"
  condition:
    - condition: state
      entity_id: sun.sun
      state: "above_horizon"
  action:
    - action: light.turn_on
      target:
        entity_id: light.everyday_calendar

- id: bedroom_everyday_calendar_nighttime
  alias: Bedroom Everyday Calendar - Nighttime
  mode: single
  trigger:
    - trigger: state
      entity_id: light.bedroom_lamp_s
  condition:
    - condition: state
      entity_id: sun.sun
      state: "below_horizon"
  action:
    - action: >
        {% if states('light.bedroom_lamp_s') == "on" %}
          light.turn_on
        {% else %}
          light.turn_off
        {% endif %}
      target:
        entity_id: light.everyday_calendar
